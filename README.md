# Cherry üçí

**Algoritmo de Inteligencia de Negocio para la Expansi√≥n Estrat√©gica de Guarder√≠as en Espa√±a**

> "How to Create Great Things" - Respuestas Sencillas a Problemas Complejos

---

## Contexto General

| Aspecto | Detalle |
|---------|---------|
| **Programa** | Akademia: Caso Pr√°ctico 2023-2024 |
| **Organizador** | Fundaci√≥n Innovaci√≥n Bankinter |
| **Equipo** | Equipo Cereza (6 miembros) |
| **Fecha** | 12 de enero de 2024 |

### Miembros del Equipo

- C√©sar Fieiras Ceide
- Ignacio Garbayo Fern√°ndez
- √Ålvaro P√©rez Mut
- Andreu Llopis S√°nchez
- Pelayo Iglesias Rodr√≠guez
- Pelayo Ybarra P√©rez

---

## El Problema

**Objetivo:** Localizar las **100 mejores ubicaciones** para abrir guarder√≠as en Espa√±a (expansi√≥n de cadena existente).

### Especificaciones del Negocio

| Par√°metro | Valor |
|-----------|-------|
| Ni√±os por guarder√≠a | 40 |
| Coste servicio/ni√±o/mes | 450‚Ç¨ |
| Ni√±os por empleado | 10 |
| Ingresos mensuales/guarder√≠a | 18.000‚Ç¨ |
| Requisitos | Ocupaci√≥n plena, sin morosos |

### Perfil del Cliente Objetivo

- Familia con buen potencial econ√≥mico
- Miembros en edad de asistencia a guarder√≠a (0-4 a√±os)
- Miembros en edad de tener hijos (25-44 a√±os)
- Renta suficiente para evitar morosidad

---

## La Propuesta de Valor

### Filosof√≠a

**"How to Create Great Things"** - Respuestas Sencillas a Problemas Complejos

### Enfoque

1. Reunir el capital intelectual apropiado
2. Adaptar ese conocimiento a necesidades espec√≠ficas
3. Combinar e interrelacionar todo el conocimiento

### Capacidades del Sistema

- ‚úÖ Plena disponibilidad del conocimiento
- ‚úÖ Tiempo de respuesta autom√°tico
- ‚úÖ Adaptable en directo a nuevos contextos
- ‚úÖ Extrapolable/escalable a otros ecosistemas
- ‚úÖ Econom√≠a de escala (conocimiento interrelacionado)

---

## Fuentes de Conocimiento

### 1. Experto en Guarder√≠as

**√ìscar D√≠az Reim√≥ndez**
- Socio fundador de NemoMarlin
- Director ejecutivo y de expansi√≥n
- **Aporta:** Pir√°mide poblacional ideal, conocimiento del sector

### 2. Modelos de Lenguaje (LLMs)

- **Bard** (Google)
- **ChatGPT** (OpenAI)
- **Perplexity**

**Aportan:**
- Escandallo familiar clase media-alta
- Coste educadora infantil privada (2.000-4.000‚Ç¨/mes seg√∫n Infojobs)
- Porcentaje de gasto en educaci√≥n (~10%)
- *Insight:* "La compra de nueva vivienda est√° relacionada con la ampliaci√≥n de familia"
- *Insight:* "Las personas duermen en el mejor lugar que pueden permitirse"

### 3. Datos Oficiales

- **INE:** Edad media para tener hijos (32 a√±os)
- **Ministerio de Educaci√≥n:** Registro de guarder√≠as privadas (validaci√≥n)
- **Bankinter:** Datos demogr√°ficos, rentas por secci√≥n censal

### 4. Datos Inmobiliarios (validaci√≥n)

- **FotoCasa:** Precio metro cuadrado
- **Idealista:** Precio alquiler

### 5. Experto en Marketing (an√≥nimo)

---

## Las 3 Preguntas que Responde Cherry

1. **¬øCu√°l es la pir√°mide de poblaci√≥n ideal para el negocio?**
2. **¬øEn qu√© rango de renta debe estar la familia ideal?**
3. **¬øC√≥mo saber si la familia est√° en el mejor momento para adquirir el servicio?**

---

## An√°lisis Detallado

### A. Pir√°mide Poblacional Ideal

| Franja | Relevancia | Justificaci√≥n |
|--------|------------|---------------|
| 0-4 | **Muy alta** | Edad objetivo (ni√±os de guarder√≠a) |
| 5-9 | Media-baja | Competencia con colegios es impracticable |
| 10-14 | Baja | Necesaria para ajuste real |
| 15-19 | Residual | - |
| 20-24 | Media | Comienzo edad de hijos y poder adquisitivo |
| 25-29 | Media-alta | Cercano a 32, pero menos poder adquisitivo |
| 30-34 | **Alta** | Seg√∫n INE, 32 es edad media para tener hijos |
| 35-39 | Media-alta | M√°s asentada y m√°s PA, pero menos probable hijos |
| 40-44 | Media | M√°s asentada (‚Ç¨) pero m√°s edad |
| 45-49 | Media-baja | Posible p√∫blico con m√°s PA, nuevas formas fecundaci√≥n |
| 50-54 | Baja | Necesaria para ajuste real |
| 55-59 | Baja | Necesaria para ajuste real |
| 60-64 | Residual | - |

### B. Rango de Renta √ìptimo

**Escandallo familiar clase media-alta** (seg√∫n Bard):

| Porcentaje | Actividad |
|------------|-----------|
| 26,20% | Vivienda |
| 15,80% | Transporte |
| 13,70% | Alimentaci√≥n y bebidas |
| **10,40%** | **Educaci√≥n y cultura** |
| 9,90% | Ropa y calzado |
| 7,40% | Atenci√≥n sanitaria |
| 6,20% | Ocio y cultura |
| 6,20% | Vivienda y servicios b√°sicos |

**C√°lculo del rango:**

F√≥rmula: `(Coste √ó 10) √ó 12`

- **Renta m√≠nima:** (450 √ó 10) √ó 12 = **54.000‚Ç¨/a√±o**
  - Puede pagar guarder√≠a (450‚Ç¨/mes)
- **Renta m√°xima:** (2.000 √ó 10) √ó 12 = **240.000‚Ç¨/a√±o**
  - No puede pagar educadora privada (2.000‚Ç¨/mes), as√≠ que usar√≠a guarder√≠a

### C. Momento del Mercado Inmobiliario

**L√≥gica:** La compra de vivienda correlaciona con ampliaci√≥n familiar

**Escala de momento:**

| Indicador | Valor |
|-----------|-------|
| ++ | 1 |
| + | 0,5 |
| = | 0 |
| - | -0,5 |
| -- | -1 |

Se calcula la media entre pisos y casas para cada secci√≥n.

---

## El Algoritmo Cherry

### Funcionamiento por Fases

```
ENTRADA: Datos de secciones censales
    ‚Üì
FASE 1: Ordenaci√≥n por ajuste poblacional (Par√°metro P)
    ‚Üì
FASE 2: Filtrado por renta (54.000‚Ç¨ ‚â§ Renta ‚â§ 240.000‚Ç¨)
    ‚Üì
FASE 3: Filtrado por momento (selecci√≥n escalonada M=1, 0.75, 0.5...)
    ‚Üì
SALIDA: Mapa con las 100 mejores secciones censales
```

### Modelizaci√≥n Matem√°tica

#### Par√°metro P (Ajuste Poblacional)

```
P‚ÇÄ = Œ£ |Peso(i) - N(i)| / Peso(i)
```

Donde:
- `Peso(i)` = porcentaje asignado en pir√°mide ideal
- `N(i)` = porcentaje real de la secci√≥n

**Reglas especiales:**
- Si `Peso(i) = 0`, no se divide
- Para franjas **(0-4)** y **(30-34)**, **NO se penaliza el exceso**
- Normalizaci√≥n: `P‚ÇÄ = P‚ÇÄ/m√°x(P‚ÇÄ)`, luego `P = 1 - P‚ÇÄ`

#### Filtrado por Renta

```
54.000 ‚â§ RM2016 ‚â§ 240.000
```

#### Filtrado por Momento

Selecci√≥n escalonada: primero M=1, si < 100 ‚Üí M=0.75, etc.

---

## Comparativa con FofM

| Aspecto | Cherry | FofM |
|---------|--------|------|
| Correlaci√≥n (r) | 0.8526657 | 0.8991791 |
| F√≥rmula conocida | ‚úÖ S√≠ | ‚ùå No (caja negra Excel) |
| Penaliza exceso en 0-4 y 30-34 | ‚ùå No | ‚úÖ S√≠ |
| Modificable | ‚úÖ S√≠ | ‚ùå No |
| Interpretabilidad | **Alta** | Baja |

**Ventajas de Cherry:**
- No penaliza exceso en franjas clave
- F√≥rmula conocida y modificable
- C√°lculo simple que mide error relativo

---

## Validaci√≥n del Algoritmo

**Fuente de validaci√≥n:** Registro del Ministerio de Educaci√≥n y Formaci√≥n Profesional (guarder√≠as privadas no concertadas)

> **Nota:** Posible contaminaci√≥n al no considerar solo franquicias

### Casos de Estudio Validados

| Secci√≥n | Ubicaci√≥n | Edad predominante | Renta Hogar 2016 | Precio m¬≤ | Alquiler |
|---------|-----------|-------------------|------------------|-----------|----------|
| 2807915160 | Madrid-Costillares | 25-29 a√±os | 69.237‚Ç¨ | 4.588‚Ç¨ | 1.250‚Ç¨ |
| 2807901087 | Madrid-Justicia | 35-44 a√±os | 69.073‚Ç¨ | 7.802‚Ç¨ | 2.578‚Ç¨ |
| 2807915153 | Madrid-Colina | 25-44 a√±os | 77.122‚Ç¨ | 4.682‚Ç¨ | 1.557‚Ç¨ |
| 0801906011 | Barcelona-Sarri√†-San Gervasi | 25-64 a√±os | 54.730‚Ç¨ | 5.930‚Ç¨ | 2.521‚Ç¨ |

---

## üõ†Ô∏è Tecnolog√≠a

| Componente | Detalle |
|------------|---------|
| **Lenguaje** | R |
| **Librer√≠as** | `pyramid` (visualizaci√≥n demogr√°fica), `leaflet` (mapas interactivos) |
| **Datos** | ~8.000 secciones censales √ó ~70 variables |

---

## Estructura del Proyecto

```
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Script Ejecuci√≥n Cereza.R           # Ejecuta todo el pipeline (Cherry)
‚îÇ   ‚îú‚îÄ‚îÄ Script Ejecuci√≥n FofM.R             # Ejecuta todo el pipeline (FofM)
‚îÇ   ‚îú‚îÄ‚îÄ (0) Pir√°mide.R                      # Visualizaci√≥n pir√°mide ideal
‚îÇ   ‚îú‚îÄ‚îÄ (1) Generacion DataFrame Basico.R   # Preparaci√≥n de datos
‚îÇ   ‚îú‚îÄ‚îÄ (2) Algoritmo Cereza.R              # Implementaci√≥n Cherry
‚îÇ   ‚îú‚îÄ‚îÄ (2) Algoritmo FofM.R                # Algoritmo alternativo
‚îÇ   ‚îú‚îÄ‚îÄ (3) Mapa.R                          # Visualizaci√≥n geogr√°fica
‚îÇ   ‚îú‚îÄ‚îÄ (4) Entrenamiento.R                 # Validaci√≥n del modelo
‚îÇ   ‚îú‚îÄ‚îÄ DatosTratados.csv                   # Datos procesados
‚îÇ   ‚îú‚îÄ‚îÄ localizacion.csv                    # Coordenadas geogr√°ficas
‚îÇ   ‚îú‚îÄ‚îÄ momento.csv                         # Datos momento mercado
‚îÇ   ‚îî‚îÄ‚îÄ FofM.csv                            # Resultados FofM
‚îÇ
‚îú‚îÄ‚îÄ Presentaci√≥n Algoritmo.pdf              # Documentaci√≥n t√©cnica (38 p√°gs)
‚îú‚îÄ‚îÄ Presentaci√≥n Ventas.pdf                 # Propuesta de valor (45 p√°gs)
‚îú‚îÄ‚îÄ README.md                               # Este archivo
‚îú‚îÄ‚îÄ CLAUDE.md                               # Contexto t√©cnico para IA
‚îî‚îÄ‚îÄ LICENSE                                 # Licencia MIT
```

---

## Uso

### Prerrequisitos

```r
install.packages("pyramid")
install.packages("leaflet")
```

### Ejecuci√≥n R√°pida (Recomendado)

Ejecutar uno de los scripts que realizan todos los pasos autom√°ticamente:

- `Script Ejecuci√≥n Cereza.R` ‚Üí Pipeline completo con algoritmo Cherry
- `Script Ejecuci√≥n FofM.R` ‚Üí Pipeline completo con algoritmo FofM

### Ejecuci√≥n Paso a Paso

1. **Preparar datos:** Ejecutar `(1) Generacion DataFrame Basico.R`
2. **Ejecutar algoritmo:** Elegir uno de los dos scripts disponibles:
   - `(2) Algoritmo Cereza.R` ‚Üí Algoritmo Cherry (interpretable)
   - `(2) Algoritmo FofM.R` ‚Üí Algoritmo FofM (mayor correlaci√≥n)
3. **Visualizar resultados:** Ejecutar `(3) Mapa.R`
4. **Validar (opcional):** Ejecutar `(4) Entrenamiento.R`

---

## Entregables

- ‚úÖ Mapa interactivo con las 100 mejores secciones censales
- ‚úÖ An√°lisis por provincia
- ‚úÖ Validaci√≥n estad√≠stica (coeficiente de correlaci√≥n)
- üîú (Propuesta futura) Relaci√≥n de locales y plan de gastos de apertura

---

## Documentaci√≥n Adicional

- [Presentaci√≥n Algoritmo.pdf](Presentaci√≥n%20Algoritmo.pdf) - Documentaci√≥n t√©cnica completa
- [Presentaci√≥n Ventas.pdf](Presentaci√≥n%20Ventas.pdf) - Propuesta de valor y metodolog√≠a

---

## Licencia

Este proyecto est√° licenciado bajo la [Licencia MIT](LICENSE).

### Atribuci√≥n de Datos

Los archivos CSV de la carpeta `src/` provienen de:
- **INE (Instituto Nacional de Estad√≠stica)**: Datos demogr√°ficos y censales de acceso p√∫blico
- **Fundaci√≥n Innovaci√≥n Bankinter**: Datos p√∫blicos compartidos en el programa Akademia 2023-2024
